# Mira 系统托盘图标使用指南

## 功能说明

Mira 现在支持系统托盘图标功能！应用启动后，会在系统托盘（Windows 右下角通知区域）显示一个图标。

## 使用方法

### 1. 右键菜单
右键点击托盘图标，会显示功能菜单，包含以下选项：

#### 形状选择
- **圆形 (F1)** - 切换到圆形遮罩
- **椭圆形 (F2)** - 切换到椭圆形遮罩
- **矩形 (F3)** - 切换到矩形遮罩
- **圆角矩形 (F4)** - 切换到圆角矩形遮罩
- **心形 (F5)** - 切换到心形遮罩

#### 窗口控制
- **重置位置** - 将窗口移动到默认位置 (100, 100)
- **重置旋转** - 将窗口旋转角度重置为 0°
- **重置大小** - 将窗口大小重置为 400x400

#### 其他功能
- **显示信息** - 在日志中显示当前状态信息
- **退出** - 关闭应用程序

### 2. 快捷键
除了托盘菜单，您仍然可以使用以下快捷键：

- **F1-F5**: 切换形状
- **Tab**: 切换摄像头设备
- **空格**: 循环切换形状
- **R**: 重置窗口位置和旋转
- **鼠标拖拽**: 移动窗口
- **鼠标滚轮**: 缩放窗口
- **Ctrl + 鼠标滚轮**: 旋转窗口

## 自定义图标

### 图标要求
如果您想使用自定义托盘图标，请提供以下格式的图标文件：

- **格式**: ICO (Windows) 或 PNG (跨平台)
- **尺寸**: 
  - Windows: 16x16, 32x32, 48x48 (ICO 文件可包含多个尺寸)
  - macOS: 16x16, 32x32 (PNG, 支持 Retina 显示)
  - Linux: 16x16, 22x22, 24x24, 32x32 (PNG)
- **建议**: 使用简单、清晰的图标设计，在小尺寸下也能清晰识别

### 图标文件位置
将图标文件放置在项目根目录下，命名为：
- `icon.ico` (Windows)
- `icon.png` (macOS/Linux)

### 代码集成
在 `src/tray.rs` 的 `TrayManager::new()` 方法中，将：
```rust
let tray_icon = TrayIconBuilder::new()
    .with_menu(Box::new(menu.clone()))
    .with_tooltip("Mira - 桌面摄像精灵")
    .build()
```

修改为：
```rust
let icon = load_icon("icon.ico"); // 或 "icon.png"
let tray_icon = TrayIconBuilder::new()
    .with_menu(Box::new(menu.clone()))
    .with_tooltip("Mira - 桌面摄像精灵")
    .with_icon(icon)
    .build()
```

## 注意事项

1. **托盘图标初始化失败**: 如果托盘图标初始化失败，应用仍会正常运行，只是不会显示托盘图标
2. **菜单语言**: 当前菜单使用中文，可以根据需要修改为其他语言
3. **图标显示**: 某些系统可能需要手动展开托盘区域才能看到图标

## 技术细节

- 使用 `tray-icon` crate 实现跨平台托盘图标支持
- 托盘菜单事件在主事件循环中处理
- 支持子菜单和分隔符
- 菜单项可以动态启用/禁用

## 未来改进

- [ ] 添加自定义图标支持
- [ ] 添加摄像头设备切换子菜单
- [ ] 添加菜单项图标
- [ ] 支持多语言菜单
- [ ] 添加托盘图标动画效果
